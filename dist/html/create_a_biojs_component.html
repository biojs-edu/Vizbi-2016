<html>

    <head>
        <meta charset="UTF8">
        <link rel="stylesheet" type="text/css" href="../css/App.css">
        <link rel="stylesheet" type="text/css" href="../css/markdown.css">
        
        <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/styles/zenburn.min.css">
		<script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/highlight.min.js"></script>
        <link rel="stylesheet" type="text/css" href="../css/biojs.css">

<script src="https://wzrd.in/bundle/biojs-vis-example@0.1.1"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.rawgit.com/4ndr01d3/biojs-vis-example/master/css/main.css">

    </head>
    
    <body>
        
        <div class="reveal">
        
            <div class="slides">
                <section>
                     <h1>BioJS</h1>
                     <h4>Reuse, <b>develop</b> and share biological visualisation with BioJS</h4>
                    <div class="bounce arrow"></div>
                </section>
                <section>
                     <h3>TASK</h3>
                     <p class="first_in_slide left_create">Create a BioJS component that displays a barchart that visualizes de contribution of the bases of a biological sequence.</p>
                     <br/>
				     <img src="../img/barchart.png" style="border:0px"/>
                     <code class="inline">CAGTGCATGatACGTCAGTGCATGCTGGGGGGGGGgcatgcatgcatgCC</code>
                </section>
                <section>
                	<section>
						<h2>What does it takes to be a BioJS component?</h2>
						<div>
							<p class="first_in_slide left_create fragment fade-in">Not much!<br/><br/>
							<span class="fragment fade-in">There are only 3 requirements to be in the BioJS registry:</span></p>
							<ol>
								<li class="fragment fade-in"><img src="https://raw.githubusercontent.com/gmetais/YellowLabTools/master/doc/img/npm-logo.png" class="inline_create"/>
									The component has to be published in npm. </li>
								<li class="fragment fade-in"><img src="http://cdn.flaticon.com/png/256/25231.png" class="inline_create"/>
									The code component has to be in github. </li>
								<li class="fragment fade-in"><img src="https://biojsnet.herokuapp.com/assets/img/biojs_circle_mint_trans.png?v=d0f6205d25" class="inline_create"/>
									The keyword <code class="inline">biojs</code> needs to be included in the package.json</li>
							</ol>
						</div>
					</section>
					<section>
						<p class="first_in_slide left_create">And a few <b>conventions</b>:</p>
						<ul>
							<li class="fragment fade-in">Names: <code class="inline">biojs-[io/rest/vis/algo/…]-[name]</code></li>
							<li class="fragment fade-in">Versioning: <a href="https://docs.npmjs.com/getting-started/semantic-versioning">Semver</a></li>
							<li class="fragment fade-in">Documentation: Use Readme.MD in your github repo</li>
						</ul>
					</section>
					<section>
						<div class="left_create top_create">
						<p class="first_in_slide left_create">But there are many <b>common</b> parts among BioJS components:</p>
						<ul>
							<li class="fragment fade-in">Packaging</li>
							<li class="fragment fade-in">Styling</li>
							<li class="fragment fade-in">Demostrating</li>
							<li class="fragment fade-in">Testing</li>
							<li class="fragment fade-in">Linting</li>
						</ul>
						</div>
					</section>
                </section>
				<section>
					<section>
						<h2>Bootstrapping</h2>
					</section>
					<section>
						<h3>Slush</h3>
						<br/>
						<div class='left_create' style='float:left;width:30%'>
							<img src="http://slushjs.github.io/assets/slush.png" style="border:0px"/>
						</div>    
						<div class='right_create' >
							<ul>
								<li>Help you generate new project structures</li>
								<li>You don’t need to use it, but it simplifies the work</li>
								<li>In order to install slush globally:
<pre><code class="bash">$ npm install -g slush
$ slush -v
[slush] 1.1.1
</code></pre>
								</li>
								<li>And to install the BioJS slush:
								    <pre><code class="bash">$ npm install -g slush-biojs</code></pre>
								</li>
							</ul>
						</div>
					</section>
					<section>
						<h3>Create your example project.</h3>
<pre><code class="bash" style="max-height: 500px;">$ mkdir biojs-vis-example
$ cd biojs-vis-example
$ slush biojs
[slush] Using slushfile /usr/local/lib/node_modules/slush-biojs/slushfile.js
[16:53:59] Starting 'biojs:default'...
? Module name? (required) biojs-vis-example
? Description? Creating a basic example for biojs
? Module version? 0.1.0
? Author name? gsalazar
? Author email? gsalazar@ebi.ac.uk
? Github username? 4ndr01d3
? Keywords for npm (separate with comma) biojs,barchart,d3
? A visualization lib? Yes
? Unit tests: No
? Add a example css file? No
? Configure a build system? (Gulp) No
? Linting (Check code style with JSHint) No
? Choose your license type: Apache-2.0
? Is this correct? Yes
</code></pre>
					</section>
					<section>
						<h3>What did we get?</h3>
						<br/>
						<div class='left_create' style='float:left;width:30%'>
							<img src="../img/biojs_folders.png" style="border:0px"/>
						</div>    
						<div class='right_create'>
							<p class='left_create' >Available npm commands:
<pre><code class="bash">$ npm run build</code></pre>
<pre><code class="bash">$ npm run sniper</code></pre>
<pre><code class="bash">$ npm run test</code></pre>
<pre><code class="bash">$ npm run watch</code></pre>
<pre><code class="bash">$ npm run w
...
running: http://localhost:9090
...
</code></pre>
<img src="../img/biojs_slush_result.png" />
					</section>
					<section>
						<h3>Playing with the example</h3>
						<br/>
						<p class='left_create' >Keep <code class="inline">npm run w</code> running. <br/><br/>Open the example file <code class="inline">biojs-vis-example/examples/simple.js</code> in your favourite editor:</p>
<pre><code class="javascript">// if you don't specify a html file, the sniper will generate a div with id "rootDiv"
var app = require("biojs-vis-example");
var instance = new app({el: rootDiv, text: 'biojs'});</code></pre>
						<p class="left_create">Then try changing the <code class="inline">text</code> option and refreshing your browser.</p>
					</section>
					<section>
						<p class="left_create">The <code class="inline">npm run w</code> action, detects changes in your files, re-bundles the <code class="inline">biojs-vis-example/build/example.js</code> file, and exposes the result on <a href="http://localhost:9090/examples/simple">http://localhost:9090/examples/simple</a></p>
						<br/>
						<div class="fragment fade-in">
							<p><b>Task</b>: Add an style file.</p>
							<img src="../img/biojs_adding_css.png" />
						</div>
						<div class="fragment fade-in"><br/>
							<p class="left_create">Create a CSS file in this path: <code class="inline">biojs-vis-example/css/main.css</code>
							<pre><code class="css">.header {
	font-weight: bold;
	color: green;
}
</code></pre>
						<div>
					</section>
					<section>
						<div><br/>
							<p class="left_create">Add the following line at the end of the <code class="inline">biojsvisexample()</code> function, in the JavaScript file: <code class="inline">biojs-vis-example/lib/index.js</code></p>
							<pre><code class="css">this.el.setAttribute("class", "header");</code></pre>
						</div>
						<div class="fragment fade-in"><br/>
							<p class="left_create">Include the style file in the npm file: <code class="inline">biojs-vis-example/package.json</code>
							<pre><code class="css">  "...
sniper": {
  "js": [ "/build/example.js"],
  "css": [ "/css/main.css"],
  "snippets": ["examples"],
  "first": "simple"
}, 
...
</code></pre>
							<p class="left_create">This requires to restart <code class="inline">npm run w</code> for the sniper to consider the new file</p>
						</div>
					</section>

				</section>
				<section>
					<section>
						<h2>Modules and Dependencies</h2>
					</section>
					<section>
						<h3>Modules in Node.js</h3>
						<p><a href="https://nodejs.org/api/modules.html">https://nodejs.org/api/modules.html</a></p>
						<br/>
						<p class='left_create' >Files and modules are in one-to-one correspondence.</p>
						<div class="fragment fade-in"><br/>
							<p class='left_create' >Export 1 object per file, assigning it to <code class="inline">module.exports</code>. For example the file <code class="inline">biojs-vis-example/lib/example.js</code>:</p>
							<pre><code class="javascript">module.exports = " - from another module";</code></pre>
						</div>
						<div class="fragment fade-in"><br/>
							<p class='left_create' >And to import it in another file you can use the function <code class="inline">require()</code>. For example in the file <code class="inline">biojs-vis-example/lib/index.js</code>:</p>
							<pre><code class="javascript">var example = require("./example.js");
console.log(example); // - from another module</code></pre>
						</div>
						<br/>
					</section>
					<section>
						<h3>Next Task</h3>
						<p class='left_create' >Remove the functionality of displaying <code class="inline">"Hello BioJS"</code> and make it show <code class="inline">"BARCHART"</code>, but the code should be in a separate module.</p>
							<img src="../img/biojs_barchart_text.png" />
						<div class="fragment fade-in">
							<p class='left_create' ><code class="inline">biojs-vis-example/lib/barchart.js</code>:</p>
							<pre><code class="javascript">var Barchart = function(opts) {
	var container = opts.el;
	container.textContent = "BARCHART";
	container.setAttribute("class", "header");
}
module.exports = Barchart;
</code></pre>
						</div>
						<div class="fragment fade-in">
							<p class='left_create' ><code class="inline">biojs-vis-example/lib/index.js</code>:</p>
							<pre><code class="javascript">var  biojsvisexample;
var Barchart = require("./barchart.js");
module.exports = biojsvisexample = function(opts){
	var bc = new Barchart(opts);
};
</code></pre>
						</div>
					</section>
					<section>
						<h3>Dependencies in Node.js</h3>
						<br/>
						<p class='left_create' >Using npm is possible to install any module that is in the repository. For example:</p>
						<pre><code class="bash">$ npm i d3 --save</code></pre>
						<p class='left_create' >And then you can use it as a module in your files with:</p>
						<pre><code class="javascript">var d3 = require('d3');</code></pre>
					</section>
					<section>
						<h3>Next Task</h3>
						<br/>
						<p class='left_create' >Refactor your code to use D3 to manipulate your DOM.</p>
							<img src="../img/biojs_barchart_text_d3.png" />
						<div class="fragment fade-in">
							<p class='left_create' ><code class="inline">biojs-vis-example/lib/barchart.js</code>:</p>
							<pre><code class="javascript">var d3 = require("d3");

var Barchart = function(opts) {
  var container = opts.el;

  d3.select(container)
    .attr("class", "header")
    .text("Space for a barchart with D3!");
}

module.exports = Barchart;
</code></pre>
						</div>
					</section>
				</section>
				<section>
					<section>
						<h2>Data Processing</h2>
					</section>
					<section>
						<h3>Next Task</h3>
						<br/>
						<p class='left_create' >Given a sequence in your options, count how many times each base appears in it, and then display this values in the page.</p>
							<img src="../img/biojs_counting_bases.png" />
						<br/>						
						<div class="fragment fade-in">
							<p class='left_create' ><code class="inline">biojs-vis-example/examples/simple.js</code>:</p>
							<pre><code class="javascript">var app = require("biojs-vis-example");
var instance = new app({el: rootDiv, sequence: "CAGTGCATGatACGTCAGTGCATGCTGGGGGGGGGgcatgcatgcatg"});
</code></pre>
						</div>
					</section>
					<section>
							<p class='left_create' ><code class="inline">biojs-vis-example/lib/barchart.js</code>:</p>
						<pre><code class="javascript" style="max-height: 500px;">var getBases = function(sequence) {
  var s = sequence.toUpperCase();
  var bases = {};
  for (var i =0;i&lt;s.length;i++){
    if (typeof bases[s[i]] == "undefined")
      bases[s[i]] = 1;
    else
      bases[s[i]]++; 
  }
  return bases;
} // Object {C: 9, A: 9, G: 20, T: 10}
var Barchart = function(opts) {
  var container = opts.el;
  var bases = getBases(opts.sequence);
  d3.select(container)
    .attr("class", "header")
    .text("Bases:")
    .selectAll("p")
    .data(d3.keys(bases)).enter()
    .append("p")
      .text(function(d){ return d +": "+bases[d]; });
}
</code></pre>
						<p>Interested in d3?? Read about <a href="https://bost.ocks.org/mike/join/">Thinking with Joins</a></p>
					</section>

				</section>
				<section>
					<section>
						<h2>Visualizing</h2>
						<a href="https://bost.ocks.org/mike/bar/">https://bost.ocks.org/mike/bar/</a>
					</section>
					<section>
						<h3>Next Task</h3>
						<br/>
						<p class='left_create' >Change the text representation for a barchart.</p>
					     <img src="../img/barchart.png" style="border:0px"/>
					</section>
					<section>
						<div >
							<p class='left_create' ><code class="inline">biojs-vis-example/lib/barchart.js</code>:</p>
							<pre><code class="javascript" style="max-height: 500px;">...
var Barchart = function(opts) {
  var container = opts.el,
    bases = getBases(opts.sequence),
    keys = d3.keys(bases),
    values = keys.map(function(e){return bases[e];});
  
  var x = d3.scale.linear()
    .domain([0, d3.max(values)])
    .range([0, 420]);
  
  d3.select(container)
    .attr("class", "chart")
    .selectAll("div")
    .data(keys)
    .enter().append("div")
      .style("width", function(d) { return x(bases[d]) + "px"; })
      .text(function(d) { return bases[d]+":"+d; });
}
</code></pre>
						</div>
					</section>
					<section>
						<h3>Style!</h3>
						<p class="left_create"><code class="inline">biojs-vis-example/css/main.css</code></p>
						<pre><code class="css">
.chart div {
  font: 10px sans-serif;
  background-color: steelblue;
  text-align: right;
  padding: 3px;
  margin: 1px;
  color: white;
}

.chart div:hover {
  background-color: cadetblue;
  font-size: 12px;
}

</code></pre>
					</section>
				</section>
				<section>
					<section>
						<h2>Publishing</h2>
					</section>
					<section>
						<h3>Checklist</h3>
						<ul>
							<li class="fragment fade-in">
								<img src="http://cdn.flaticon.com/png/256/25231.png" class="inline_create"/>
								Have you put your component in GitHub?<br/>
								<a href="https://help.github.com/">GitHub Help</a>
							</li>
							<li class="fragment fade-in">
								<img src="https://raw.githubusercontent.com/gmetais/YellowLabTools/master/doc/img/npm-logo.png" class="inline_create"/>
								Have you signed up in npm?<br/>
								<a href="https://www.npmjs.com/signup">npm signup</a>
							</li>
							<li class="fragment fade-in">
								<img src="https://raw.githubusercontent.com/gmetais/YellowLabTools/master/doc/img/npm-logo.png" class="inline_create"/>
								Have you added your npm user in this terminal?
								<pre><code class="bash">$ npm adduser</code></pre></li>
							<li class="fragment fade-in">
								<img src="https://biojsnet.herokuapp.com/assets/img/biojs_circle_mint_trans.png?v=d0f6205d25" class="inline_create"/>
								Does your <code class="inline">package.json</code> file includes the biojs tag and points to the right github repo?<br/>
								<a href="http://edu.biojs.net/101/publish_it/">Other Checking.</a></li>
						</ul>
						<div class="fragment fade-in">
							<p class="left_create">Then simply:</p>
							<pre><code class="bash">$ npm publish</code></pre></li>
						</div>
					</section>
					<section>
						<h3>Result</h3>
						<div class="fragment fade-in">
							<p class="left_create">Here is the code in this page:</p>
							<pre><code class="html">&lt;div id='snippetDiv'>&lt;/div>
&lt;script>
var rootDiv = document.getElementById('snippetDiv');
// if you don't specify a html file, the sniper will generate a div with id "rootDiv"
var app = require("biojs-vis-example");
var instance = new app({el: rootDiv, sequence: "CAGTGCATGatACGTCAGTGCATGCTGGGGGGGGGgcatgcatgcatgCC"});
&lt;/script>
</code></pre>
						</div>
						<br/>
						<div class="fragment fade-in">
							<p class="left_create">And here how it looks:</p>
							<div id='snippetDiv' style="height: 100%;"></div>
						</div>
						<br/>
						<div class="fragment fade-in">
							<a href ="http://biojs.io/d/biojs-vis-example">Check the registry</a>
						</div>
						<script>
var rootDiv = document.getElementById('snippetDiv');
// if you don't specify a html file, the sniper will generate a div with id "rootDiv"
var app = require("biojs-vis-example");
var instance = new app({el: rootDiv, sequence: "CAGTGCATGatACGTCAGTGCATGCTGGGGGGGGGgcatgcatgcatgCC"});
						</script>
					</section>
				</section>
                <section>
                    <p><a href="../index.html#/1">Back to program</a></p>
                </section>
            </div>
        </div>
        <div class="reveal"  style="position: absolute;top: 1%;left: 1%%;">
			<div class="logo"></div>
		</div>
        <div class="reveal"  style="position: absolute;top: 4%;left: 8%;">
			<h4 class="vizbi">@ VIZBI 2016</h4>
		</div>
        
    <script src="../js/App.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
    </body>
</html>